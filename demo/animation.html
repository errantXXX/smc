<html>
<head>

</head>
<body><div class="contents"><canvas cjs-noclip="1" id="my" data-width="320" data-height="327" style=""></canvas></div>
<script src="../js/lib/require.js"></script>
<script src="js/lib/Game.js"></script>

<script>

    require.config({ baseUrl: '/Astral/demo/js/',
        paths : {
            text : '../../js/lib/require-text', //text is required
            json : '../../js/lib/require-json' //alias to plugin
        },
        shim:{
            jquery:{exports:"$"},
            underscore:{exports:"_"},
            backbone:{
                deps:["underscore","jquery"],exports:"Backbone"
            },
            typist:{deps:["jquery"]}
        }


    });
    var loadCreateJS = function(a) {

        0 === Game.setting.cjs_mode ? require(["lib/createjs"], function() {

            require(["lib/soundjs-0.5.2-patch"], function() {

                a()
            })
        }) : 1 === Game.setting.cjs_mode && require(["createjsliteopengl"], function(b) {
            window.createjs = b, require(["lib/createjslite-patch"], function() {
                a()
            })
        })
    };
    require(['../js/lib/common.js'],function(){
        require(["util/device"]);
        var userAgent = (new UAParser).getResult();
        Game.ua = Game.ua ? _.extend(Game.ua, userAgent) : userAgent;
        var globalGame = window.Game;
        loadCreateJS(function(){

            require(['json!cjs/json/wolf-sprite.json','json!cjs/json/wolf-action.json'],function(wolfData, wolfAction){

                var spriteSheet = new createjs.SpriteSheet(wolfData);
                var animation = new createjs.Sprite(spriteSheet);
                var wolfFrames = wolfData.animations.Asset.frames;
                var wolfSprite = [];
                var temp;
                for(var i = 0; i < wolfFrames.length; i++) {
                    (function(a){
                        (wolfSprite["Asset_" + wolfFrames[a]] = function () {
                            this.spriteSheet = spriteSheet
                            this.gotoAndStop(a);
                        }).prototype = temp = new createjs.Sprite();

                    })(i);


                };

                console.info(wolfSprite)
                var stage = new createjs.Stage("my");
                createjs.Ticker.addEventListener("tick", stage);

                var wolfAnimationAction = [];
                (wolfAnimationAction['test'] = function(){
                    this.instanceList = [];
                    this.instanceList['Asset_1'] = new wolfSprite['Asset_1'];
                    this.instanceList['Asset_1'].parent = this;
                    this.instanceList['Asset_2'] = new wolfSprite['Asset_2'];
                    this.instanceList['Asset_2'].parent = this;
                    this.instanceList['Asset_3'] = new wolfSprite['Asset_3'];
                    this.instanceList['Asset_3'].parent = this;
                    this.instanceList['Asset_4'] = new wolfSprite['Asset_4'];
                    this.instanceList['Asset_4'].parent = this;
                    this.timeline.addTween(eval("createjs.Tween.get({}).to({state:[{t:this.instanceList['Asset_1']}]}).to({state:[{t:this.instanceList['Asset_2']}]},1).to({state:[{t:this.instanceList['Asset_3']}]},1).to({state:[{t:this.instanceList['Asset_4']}]},1).wait(1).call(function(){this.stop();})"));
//




                }).prototype = temp = new createjs.MovieClip();

                var myMC = new  wolfAnimationAction['test'];
                //stage.addChild(myMC);
                myMC.gotoAndPlay("start");
                var wolfCjs = [];
                var obj;
                function make(){
                    var action = wolfAction.actions.action;

                    for(var i=0;i <action.length;i++) {
                        var actionName = action[i]["-name"];

                            var command = "createjs.Tween.get({})";
                            for(var j=0;j < action[i].layer[0].frame.length;j++) {

                                if( action[i].layer[0].frame[j].element) {
                                    command += ".to({state:[{t:new  wolfSprite[Asset_"+action[i].layer[0].frame[j].element['-assetId']+"]}]})"
//                                    wolfAnimationAction[action[i]["-name"]].push({
//                                       frame: action[i].layer[0].frame[j].element['-assetId'],
//                                        x: action[i].layer[0].frame[j].element['-x'] || '0',
//                                        y: action[i].layer[0].frame[j].element['-y'] || '0',
//                                        rotation: action[i].layer[0].frame[j].element['-rotation'] || '0'
//                                    })
                                }
                                console.info("command",command)
                            };



                    }

                };
                make();
                console.info(wolfCjs);


            })
        })

    });





</script>
</body>
</html>